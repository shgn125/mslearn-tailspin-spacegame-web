# ASP.NET
# Build and test ASP.NET projects.
# Add steps that publish symbols, save build artifacts, deploy, and more:
# https://docs.microsoft.com/azure/devops/pipelines/apps/aspnet/build-aspnet-4

trigger:
- main

pool:
  vmImage: 'windows-latest'

variables:
 - name: one
   value: initialValue 
 Branchs:
    -gitBranch: DEV 
     ivyBranch: BRC_S_ALELO_ACQ
    -gitBranch: HML 
     ivyBranch: BRC_S_ALELO_ACQ_HML
    -gitBranch: PROD 
     ivyBranch: BRC_S_ALELO_ACQ_PROD
    -gitBranch: PrePRD 
     ivyBranch: BRC_S_ALELO_ACQ_PrePRD
    -gitBranch: FIX 
     ivyBranch: BRC_S_ALELO_ACQ_FIX
  CURRENT_BRANCH: Undefined

steps:
  - script: |
      echo ${{ variables.one }} # outputs initialValue
      echo $(one)
    displayName: First variable pass
  - bash: echo '##vso[task.setvariable variable=one]secondValue'
    displayName: Set new variable value
  - script: |
      echo ${{ variables.one }} # outputs initialValue
      echo $(one) # outputs secondValue
      echo $(Build.SourceBranch)
      echo $(Build.SourceBranchName)
      echo $[eq(variables['Build.SourceBranch'], 'refs/heads/main')]
    displayName: Second variable pass
  -${{ each value in variables.Branchs }}:
    - script: echo ${{ value.icyBranch }}  
    displayName: Test Dictionaries
